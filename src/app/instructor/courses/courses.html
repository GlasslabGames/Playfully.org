<div class="container gl-tabs">
    <ul class="gl-tab-container _nav _nav-tabs" role="tablist">
        <li class="gl-tab"
            ng-class="{'active': !showArchived}">
            <a href ui-sref="courses({courseStatus:''})">Active Classes</a>
        </li>
        <li class="gl-tab"
            ng-class="{'active': showArchived}">
            <a href ui-sref="courses({courseStatus:'/archived'})">Archived Classes</a>
        </li>
    </ul>
</div>

<!-- courses-list.html -->

<div class="gl-courses-container">
  <div class="container">
    <div ng-show="!showArchived">
      <hr class="rule rule--blue" />
      <div class="gl-courses-add gl-courses-add--blue" ui-sref="newCourse">
        <div class="bu-add-circle bu-add-circle--blue"></div>
        Create New Class
      </div>
      <hr class="rule rule--blue" />

      <div ng-hide="courses.length" class="gl-courses--blank text-center">
        Get started by clicking on the "Create New Class" button above!
      </div>

      <div ng-show="courses.length && activeCourses.length == 0" class="gl-courses--blank text-center">
        You currently have no active classes.<br/>Create a new class or unarchive an old class by heading over to the "Classes" tab above!
      </div>
    </div>

    <div 
      class="gl-courses--blank text-center"
      ng-show="state.includes('courses.archived') && archivedCourses.length == 0">
        None of your classes have been archived
    </div>


    <div ng-show="courses.length">
      <div class="gl-course container-fluid"
        ng-repeat="(courseKey,course) in courses | filter:{archived: showArchived}">
        <div class="row gl-course-info">
          <div class="col-md-3 gl-course-desc">
            <h3 class="gl-course-title" ng-bind="course.title"></h3>
            <!--div>Teacher: <span ng-bind="currentUser.firstName"></span></div-->
            <div>Grade:
              <span ng-repeat="grade in course.grade">
                {{ grade }}<span ng-show=" ! $last ">,</span>
              </span>
            </div>
            <div ng-if="!course.lockedRegistration">Class Code: <span ng-bind="course.code"></span></div>
            <div ng-if="course.lockedRegistration"><i class="fa fa-lock"></i> Registration Locked</div>
            <div ng-if="course.archived">
              Archived On: <span ng-bind="course.archivedDate | date:longDate"></span>
            </div>
            <div class="gl-margin--Ts">
              <button type="button" class="btn gl-btn--blue"
                ng-if="course.archived"
                ui-sref="unarchiveCourse({id: course.id})">
                Reactivate This Class
              </button>
              <div ng-if="showCourseEdit(course)" class="btn-group" dropdown is-open="status.isopen">
                <button type="button" class="btn gl-btn--blue dropdown-toggle" ng-disabled="disabled">
                  Edit <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu">
                  <li><a ui-sref="editCourse({id:course.id})">Edit Class Info</a></li>
                  <li ng-if="!course.lockedRegistration"><a ui-sref="lockCourse({id:course.id})">Lock Registration</a></li>
                  <li ng-if="course.lockedRegistration"><a ui-sref="unlockCourse({id:course.id})">Unlock Registration</a></li>
                  <li><a ui-sref="archiveCourse({id:course.id})">Archive Class</a></li>
                  <li><a ui-sref="assignGamesToCourse({id:course.id})">Assign More Games</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="col-md-9 gl-course-games">
            <div class="text-center gl-courses--blank" ng-hide="course.games.length">
              No games assigned yet
            </div>
            <div ng-show="course.games.length">
              <div class="gl-course-game text-center"
                ng-repeat="game in course.games"
                ng-show="gamesInfo[game.id].enabled">

                <div class="gl-course-game-thumb gl-thumb-{{ game.id }}">
                  <div ng-if="game.settings.hasOwnProperty('missionProgressLock')">
                    <div class="gl-course-game-lock"
                      ng-if="game.settings.missionProgressLock"
                      ui-sref="unlockMissions({courseId: course.id, gameId: game.id})">
                    </div>
                    <div class="gl-course-game-lock gl-course-game-unlocked"
                      ng-if="!game.settings.missionProgressLock"
                      ui-sref="lockMissions({courseId: course.id, gameId: game.id})">
                    </div>
                  </div>
                </div>
                {{ gamesInfo[game.id].longName }} 
              </div>

              <div ng-if="course.games.length < 3" class="gl-course-game text-center text-grey5" ui-sref="assignGamesToCourse({id:course.id})">
                <div class="gl-course-game-thumb gl-thumb-game-add">
                  <div class="bu-add-circle bu-add-circle--grey"></div>
                </div>
                Assign More Games
              </div>
            </div>
          </div>
        </div>

      <div class="gl-course-students row" ng-class="{'gl-course-students--open': course.isOpen}">
          <div class="col-md-2">
            <span class="gl-students-heading" ng-show="course.isOpen">Last Initial</span>
          </div>
          <div class="col-md-3">
            <span class="gl-students-heading" ng-show="course.isOpen">First Name</span>
          </div>
          <div class="col-md-3">
            <span class="gl-students-heading" ng-show="course.isOpen">Screen Name</span>
          </div>
          <div class="col-md-4 text-right">
            <button class="btn btn-sm gl-btn--blue"
              ng-hide="course.isOpen"
              ng-disabled="course.studentCount == 0"
              ui-sref="showStudentList({id: course.id})">
              View Student List (<span ng-bind="course.studentCount"></span>)
            </button>
            <button class="btn btn-sm gl-btn--white"
              ng-show="course.isOpen"
              ui-sref="courses({courseType: (showArchived ? '/archived' : '')})">
              Close Student List (<span ng-bind="course.studentCount"></span>)
            </button>
          </div>
          <div ui-view="studentList"></div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- END: courses-list.html -->

<div ui-view="courseModal"></div>
