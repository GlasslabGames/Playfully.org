<div class="report-container--wide gl-margin--Txl gl-margin--Bxl">
    <div ng-include src="'instructor/reports/_students.html'"></div>

    <div class="report-body report-body--wide gl-pad-Al" style="min-height: 623px">

        <div class="gl-drk12_b-l-container">

            <button class="fa fa-question-circle gl-drk12_b-helpicon"
                    ui-sref="modal-xlg.drk12_bInfo({type:'info'})"
                    type="button"></button>

            <h1 class="gl-drk12_b-heading">Progress Report</h1>

            <p class="gl-drk12_b-text" ng-bind="reports.selected.description"></p>

            <tabset class="gl-drk12_b-tabs" justified="true">
                <tab heading="Class View" active="activeTab[0]" ng-click="selectTab(0)">
                    <div class="gl-drk12_b-l-containerclass">
                        <h3 class="gl-drk12_b-heading gl-drk12_b-heading-secondary">Class Progress</h3>
                        <div id="drk12_bChart" ng-init="doDrawCourseStatusChart()">Chart Data</div> <!-- TODO: Redine this -->
                        <h3 class="gl-drk12_b-heading gl-drk12_b-heading-secondary">Current Class Skill Level</h3>
                        <h4 class="gl-drk12_b-heading gl-drk12_b-heading-tertiary">Competency Levels</h4>
                        <ul class="gl-drk12_b-l-progressicons">
                            <li class="gl-drk12_b-progressicon" ng-class="progressType.class" ng-repeat="progressType in progressTypes">{{progressType.title}}</li>
                        </ul>
                        <hr/>
                        <ul class="gl-drk12_b-l-progressicons">
                            <li class="gl-drk12_b-progressicon gl-drk12_b-progressicon-large" ng-class="getSkillClass(key)" ng-repeat="(key, skill) in reports.selected.skills"
                                    ng-click="goToStudentViewWithSkill(key)">
                                <span tooltip="{{skill.description}}" tooltip-placement="bottom">{{skill.name}}</span>
                            </li>
                        </ul>
                    </div>
                </tab>
                <tab heading="Student View" active="activeTab[1]" ng-click="selectTab(1)">
                    <div class="gl-drk12_b-l-containerstudent">
                        <h3 class="gl-drk12_b-heading gl-drk12_b-heading-tertiary">Competency Levels</h3>
                        <ul class="gl-drk12_b-l-progressicons">
                            <li ng-repeat="progressType in progressTypes" class="gl-drk12_b-progressicon" ng-class="progressType.class">{{progressType.title}}</li>
                        </ul>
                        <hr/>
                        <div class="gl-drk12_b-competencyskills">
                            <h3 class="gl-drk12_b-competencyskills-x-heading">Select Competency Skills</h3>
                            <ul>
                                <li ng-repeat="header in columns.headers" ng-if="$index > 1">
                                    <label>
                                        <input type="checkbox" ng-model="header.checked"/>
                                        {{header.title}}
                                    </label>
                                </li>
                            </ul>
                        </div>
                        <table class="table gl-reports-table gl-drk12_b-table" ng-class="{'gl-reports-table--ie': isIE}">
                            <thead>
                                <tr class="gl-drk12_b-table-x-header">
                                    <th rowspan="2">
                                        <button class="gl-drk12_b-tablesort" ng-click="sortSelected(columns.headers[0].value)" type="button">
                                            {{columns.headers[0].title}}
                                            <i ng-class="columns.current===columns.headers[0].value ? (columns.reverseSort ? 'highlight fa fa-sort-up' : 'highlight fa fa-sort-down' ) : 'fa fa-sort-down'"></i>
                                        </button>
                                    </th>
                                    <th rowspan="2">
                                        <button class="gl-drk12_b-tablesort" ng-click="sortSelected(columns.headers[1].value)" type="button">
                                            {{columns.headers[1].title}}
                                            <i ng-class="columns.current===columns.headers[1].value ? (columns.reverseSort ? 'highlight fa fa-sort-up' : 'highlight fa fa-sort-down' ) : 'fa fa-sort-down'"></i>
                                        </button>
                                    </th>
                                    <th colspan="{{numberOfColumnsChecked()}}">Progress for Most Recent Level</th>
                                </tr>
                                <tr class="gl-drk12_b-table-x-headersecondary">
                                    <!-- first th is covered by previous row -->
                                    <!-- second th is covered by previous row -->
                                    <th ng-repeat="header in columns.headers" ng-if="$index > 1 && header.checked">
                                        <button class="gl-drk12_b-tablesort gl-drk12_b-tablesort-secondary" ng-click="sortSelected(header.value)" type="button" tooltip="{{header.description}}" tooltip-placement="bottom">
                                            {{header.title}}
                                            <i ng-class="columns.current===header.value ? (columns.reverseSort ? 'highlight fa fa-sort-up' : 'highlight fa fa-sort-down' ) : 'fa fa-sort-down'"></i>
                                        </button>
                                    </th>
                                </tr>
                                <tr>
                                    <th colspan="6" class="gl-reports-divider--blue"></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="gl-reports-table-row" ng-repeat="student in students | orderBy:userSortFunction(columns.current):columns.reverseSort" ng-if="student[0].isSelected">
                                    <td class="gl-drk12_b-table-x-name">
                                        <span>{{student[0].firstName}} {{student[0].lastName}}</span>
                                        <button class="gl-drk12_b-performancetrigger gl-clickable"
                                             ng-click="setCurrentStudent(student[0])"
                                             ui-sref="modal-xlg.drk12_bInfo({type:'studentInfo', studentId: student.id})"
                                             type="button">
                                            Performance Over Time
                                            <i class="fa fa-caret-right"></i>
                                        </button>
                                    </td>
                                    <td>{{student[0].results.currentProgress.mission}} / {{reportData.totalMissions}}</td>
                                    <td ng-repeat="header in columns.headers" ng-if="$index > 1 && header.checked">
                                        <div class="gl-drk12_b-progressicon gl-drk12_b-progressicon-table" ng-class="student[0].results.currentProgress[header.value].level"></div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </tab>
            </tabset>
        </div>
    </div>
    <script type="text/javascript">
        $('#drk12_b-header').on('scroll', function () {
            $('#drk12_b-body').scrollLeft($(this).scrollLeft());
        });

        $('#drk12_b-body').on('scroll', function () {
            $('#drk12_b-header').scrollLeft($(this).scrollLeft());
        });
    </script>
</div>
